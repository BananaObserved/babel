(ns babel.dictionary_tests
  (:require
    [errors.dictionaries :refer :all]
    [expectations :refer :all]))

;#########################################
;### Tests for supplementary functions ###
;### in errors.dictionaries            ###
;#########################################

(expect "inc" (remove-inliner "inc--inliner--5258"))
(expect "inc" (remove-inliner "inc--inliner"))
(expect "inc" (remove-inliner "inc--5258"))
(expect "inc5258" (remove-inliner "inc5258"))
(expect "inc-5258" (remove-inliner "inc-5258"))

(expect "days" (get-function-name "happy$days"))
(expect "days" (get-function-name "happy/days"))
(expect "first" (get-function-name "clojure.lang.RT.first"))
(expect "first" (get-function-name "clojure.lang.RT.first--5678"))
(expect "somethingElse" (get-function-name "somethingElse"))

(expect "anonymous-function" (check-if-anonymous-function "fn"))
(expect "anonymous-function" (check-if-anonymous-function "fn_test"))
(expect "anonymous-function" (check-if-anonymous-function "fn_"))
(expect "random_function" (check-if-anonymous-function "random_function"))

(expect "a function" (best-approximation "clojure.spec.test.alpha$spec_checking_fn$fn__2943"))
(expect "unrecognized type 3" (best-approximation "3"))
(expect "unrecognized type \"a\"" (best-approximation "\"a\""))

(expect "a string" (get-type "java.lang.String"))
(expect "a number" (get-type "java.lang.Long"))
(expect "a symbol" (get-type "clojure.lang.Symbol"))

(expect "a string " (get-dictionary-type "\"a\""))
(expect "a symbol " (get-dictionary-type "a"))
(expect "a number " (get-dictionary-type "3"))
(expect "a function " (get-dictionary-type "clojure.spec.test.alpha$spec_checking_fn$fn__2943"))
(expect "a regular expression pattern " (get-dictionary-type "#\" a \""))
(expect "a sequence " (get-dictionary-type "'()"))
(expect "a list " (get-dictionary-type "()"))
(expect "a vector " (get-dictionary-type "[3]"))
(expect "a vector " (get-dictionary-type "[3 \"a\" 5]"))
(expect "a vector " (get-dictionary-type "[3 \"a\" [5 [3]]]"))
(expect "a map " (get-dictionary-type "{:a 3}"))
(expect "a map " (get-dictionary-type "{:a 3 :b 6 :c 12 :d 24 :e 48}"))
(expect "a set " (get-dictionary-type "#{:a 3}"))
(expect "" (get-dictionary-type "nil"))
(expect "a character " (get-dictionary-type "\\a"))
(expect "a keyword " (get-dictionary-type ":a"))
(expect "a boolean " (get-dictionary-type "true"))

(expect "a?" (lookup-funct-name "a_QMARK_"))
(expect "a!" (lookup-funct-name "a_BANG_"))
(expect "a=" (lookup-funct-name "a_EQ_"))
(expect "a<" (lookup-funct-name "a_LT_"))
(expect "a>" (lookup-funct-name "a_GT_"))
(expect "a*" (lookup-funct-name "a_STAR_"))
(expect "+" (lookup-funct-name "_PLUS_"))
(expect "-" (lookup-funct-name "_"))
(expect "/" (lookup-funct-name "_SLASH_"))
(expect "a" (lookup-funct-name "a"))

(expect "first argument" (arg-str "0"))
(expect "second argument" (arg-str "1"))
(expect "third argument" (arg-str "2"))
(expect "fourth argument" (arg-str "3"))
(expect "fifth argument" (arg-str "4"))
(expect "6th argument" (arg-str "5"))
(expect "7th argument" (arg-str "6"))

(expect "zero" (number-word "0"))
(expect "10" (number-word "10"))

(expect "no arguments" (number-vals "nil" "b-length-one"))
(expect "two arguments" (number-vals "[1 2]" "b-length-one"))
(expect "no arguments" (number-vals "nil" "b-length-two"))
(expect "one argument" (number-vals "[1]" "b-length-two"))
(expect "three arguments" (number-vals "[1 2 3]" "b-length-two"))
(expect "no arguments" (number-vals "nil" "b-length-three"))
(expect "one argument" (number-vals "[1]" "b-length-three"))
(expect "two arguments" (number-vals "[1 2]" "b-length-three"))
(expect "four arguments" (number-vals "[1 2 3 4]" "b-length-three"))
(expect "no arguments" (number-vals "nil" "b-length-greater-zero"))
(expect "no arguments" (number-vals "nil" "b-length-greater-one"))
(expect "one argument" (number-vals "[1]" "b-length-greater-one"))
(expect "no arguments" (number-vals "nil" "b-length-greater-two"))
(expect "one argument" (number-vals "[1]" "b-length-greater-two"))
(expect "two arguments" (number-vals "[1 2]" "b-length-greater-two"))
(expect "two arguments" (number-vals "[1 2]" "b-length-zero-or-one"))
(expect "no arguments" (number-vals "nil" "b-length-two-or-three"))
(expect "one argument" (number-vals "[1]" "b-length-two-or-three"))
(expect "four arguments" (number-vals "[1 2 3 4]" "b-length-two-or-three"))
(expect "b-length-eight" (number-vals "[1 2 3 4]" "b-length-eight"))
(expect "no arguments" (number-vals "nil" "b-length-eight"))

(expect "function" (?-name "object\r"))
(expect "function" (?-name "ifn?\r"))
(expect "collection" (?-name "coll?"))
(expect "a" (?-name "a\r"))
(expect "a" (?-name "a?"))
(expect "a" (?-name "a?\r"))

(expect "a" (check-divide "a"))
(expect "/" (check-divide ""))
