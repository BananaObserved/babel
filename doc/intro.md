# Introduction to babel

Babel aims to transform error messages for beginners to understand them better.

#Structure
Babel exists as an nREPL middle ware. Each middle-ware is a it's heart a function that takes a message as a map, and applies a transformation too it. During that functions definition, it is is given a function that it also must call with it's transformed message. The middleware loader ensures that that function is the another middleware. This composition of middleware function is the nREPL middleware stack.

Messages generated by the client are passed to the stack, and thus exposed to each transformation in order. Finally they reach the nREPL server, and their code is evaluated, if a middleware has not handled them already. However, the results of evaulation do not go through the middleware stack, but are returned directly. This allows for more responses than inbound messages, in the case of prints, or server IO.
Babel modification of error messages works by modifying one of the keys in the message map, while it is inbound.

The ``:transport`` key in the message holds the function that will be called to bring the response back to the client. By wrapping that function, babel gains access to outgoing messages and can transform them as necessary.

##Limitation
at present, we can only access error objects as strings, not including stack traces. This limits some of our matching abilities, as we do not have full information.

#Testing
In order to test our replacements, a testing function ``trap-response`` . When an nREPL server is launched in this project, it is forced onto a specific port. During testing, ``trap-response`` connects to the nREPL server on that port and communicates with it on a direct level, executing the code and catching the response that a standard connection would display to the user, and returns it, for tests to make assertions over.
